# password 要件

#### 30日ごとに有効期限が切れる必要があるよ。
#### パスワードを変更して良い最少日数は２日だよ。
#### 有効期限の７日前に警告が表示される必要があるよ。

1. `chage -m 2 -M 30 -W 7 root`, `chage -m 2 -M 30 -W 7 ユーザー名` を実行して、現在のユーザーの期限を設定する。

1. 今後、新規ユーザーが入った時にも自動で設定されるように、管理者権限で、`/etc/login.def`を修正開始する。

1. `PASS_MAX_DAYS`の値を`30`に修正する。

1. `PASS_MIN_DAYS`を`2`に修正する。

1. `PASS_WARN_AGE`を`7`に修正する。

> `passwd`コマンドでも設定可能のようである。

#### パスワードは少なくとも十文字以上である必要があるよ。
#### パスワードは、大文字と小文字、数値が含まれている必要があるよ。
#### ３つ以上連続した文字は含めれないよ。
#### パスワードはユーザー名を含んじゃいけないよ。
#### ユーザーのパスワードには、以前のパスワードにない7種類の文字が含まれている必要があるよ。
#### これらのパスワードポリシーにはrootも従う必要があるよ。


> `man pam.d`を参照してね。`required`のことや構文について書かれているよ。
> `man pam_unix`を参照してね。オプションについて書かれているよ。
> `man pma.d`にはモジュールの場所は、`/lib/security/`にあると書かれているけどないよ笑`/usr`の中を`pam_unix`という名前を含むファイルを探してね。

1. パスワードのルールを判定するために、`apt install -y libpam-pwquality`を実行してインストールする。（もしも、設定を上書きするかどうかを聞かれた時は、OKする）

1. `/etc/pam.d/common-password`ファイルを管理者権限で開いてね。

1. `password	requisite	pam_pwquality.so retry=3`の記載がある行を次のように編集する。
```
password	requisite	pam_pwquality.so retry=3 \
	minlen=10 dcredit=-1 ucredit=-1 lcredit=-1 maxrepeat=3 usercheck=1 diffok=7 enforce_for_root
```
> `dcredit=-1`: 数値が一文字以上含まれていること
> `ucredit=-1`: 大文字が一文字以上含まれていること
> `lcredit=-1`: 小文字が一文字以上含まれていること
> `maxrepeat=3`: 文字の繰り返しが最大で３回であること。
> `usercheck=1`: ログイン名が含まれていないこと。（ログイン名が三文字以下の場合は動作しない。）
> `diffok=7`: パスワードに対して、変更（挿入、削除、置換）して同じパスワードにならないこと。
> `enforce_for_root`: `root`ユーザにもパスワードポリシーを強制する。
